<!doctype html>
<html lang="es">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Escuela Naval de Cadetes - L√≠nea de Tiempo</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <style>
    body {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', sans-serif;

    background: url("ESCUELA_NAVAL.jpg") center center / cover no-repeat fixed;

    height: 100%;
}

    
    * {
      box-sizing: border-box;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 50px 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 50px;
      color: white;
    }

    .header h1 {
      font-size: 42px;
      margin: 0 0 15px 0;
      font-weight: 700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    .header .subtitle {
      font-size: 20px;
      opacity: 0.9;
      margin-bottom: 20px;
    }



    .anchor-icon {
      display: inline-block;
      margin-right: 10px;
      font-size: 42px;
      vertical-align: middle;
    }

    /* Score Display */
    .score-display {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: #0f172a;
      padding: 15px 25px;
      border-radius: 50px;
      font-size: 18px;
      font-weight: 700;
      box-shadow: 0 5px 20px rgba(251, 191, 36, 0.5);
      z-index: 100;
    }

    /* Characters Section */
    .characters-section {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 40px;
      margin-bottom: 60px;
      border: 1px solid rgba(251, 191, 36, 0.3);
    }

    .characters-title {
      text-align: center;
      font-size: 32px;
      color: #fbbf24;
      margin-bottom: 30px;
      font-weight: 700;
    }

    .characters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
    }

    .character-card {
      background: linear-gradient(145deg, rgba(30, 41, 59, 0.8), rgba(15, 23, 42, 0.9));
      border-radius: 15px;
      padding: 30px;
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border: 2px solid transparent;
      cursor: pointer;
    }

    .character-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px rgba(251, 191, 36, 0.3);
      border-color: #fbbf24;
    }

    .character-icon {
      font-size: 60px;
      margin-bottom: 15px;
    }

    .character-name {
      font-size: 22px;
      font-weight: 700;
      color: #fbbf24;
      margin-bottom: 8px;
    }

    .character-role {
      font-size: 16px;
      color: #cbd5e1;
      margin-bottom: 15px;
      font-style: italic;
    }

    .character-year {
      display: inline-block;
      background: #fbbf24;
      color: #0f172a;
      padding: 5px 15px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 14px;
    }

    /* Timeline Section Title */
    .timeline-section-title {
      text-align: center;
      font-size: 36px;
      color: #fbbf24;
      margin-bottom: 50px;
      font-weight: 700;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    /* Single Card Display */
    .timeline-single-card {
      max-width: 900px;
      margin: 0 auto;
      padding-bottom: 50px;
    }

    .timeline-card {
      background: linear-gradient(145deg, rgba(30, 41, 59, 0.9), rgba(15, 23, 42, 0.95));
      border-radius: 20px;
      padding: 40px;
      border: 2px solid #fbbf24;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      position: relative;
      overflow: hidden;
      margin-bottom: 30px;
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    .timeline-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 8px;
      height: 100%;
      background: linear-gradient(180deg, #fbbf24, #f59e0b);
    }

    .card-year {
      display: inline-block;
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: #0f172a;
      padding: 12px 30px;
      border-radius: 25px;
      font-size: 26px;
      font-weight: 700;
      margin-bottom: 20px;
      box-shadow: 0 5px 15px rgba(251, 191, 36, 0.4);
    }

    .card-title {
      font-size: 28px;
      color: #ffffff;
      margin-bottom: 20px;
      font-weight: 700;
      line-height: 1.3;
    }

    .card-content {
      font-size: 17px;
      line-height: 1.8;
      color: #cbd5e1;
      margin-bottom: 15px;
    }

    .card-highlight {
      background: rgba(251, 191, 36, 0.15);
      border-left: 4px solid #fbbf24;
      padding: 20px;
      margin-top: 20px;
      border-radius: 8px;
      font-style: italic;
      color: #fef3c7;
      font-size: 16px;
      line-height: 1.7;
      display: none;
    }

    .card-highlight.visible {
      display: block;
    }

    .card-icon {
      position: absolute;
      top: 40px;
      right: 40px;
      font-size: 50px;
      opacity: 0.15;
    }

    /* Quiz Section */
    .quiz-container {
      background: linear-gradient(145deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.98));
      border-radius: 20px;
      padding: 50px;
      border: 3px solid #fbbf24;
      box-shadow: 0 15px 40px rgba(251, 191, 36, 0.4);
      margin-bottom: 30px;
      display: none;
    }

    .quiz-container.active {
      display: block;
    }

    .quiz-header {
      text-align: center;
      margin-bottom: 40px;
    }

    .quiz-title {
      font-size: 32px;
      color: #fbbf24;
      margin-bottom: 15px;
      font-weight: 700;
    }

    .quiz-subtitle {
      font-size: 18px;
      color: #cbd5e1;
      margin-bottom: 10px;
    }

    .quiz-progress {
      display: inline-block;
      background: rgba(251, 191, 36, 0.2);
      padding: 10px 25px;
      border-radius: 20px;
      font-size: 16px;
      color: #fbbf24;
      font-weight: 600;
    }

    .question-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 15px;
      padding: 30px;
      margin-bottom: 30px;
      border: 2px solid rgba(251, 191, 36, 0.3);
    }

    .question-text {
      font-size: 20px;
      color: #ffffff;
      margin-bottom: 25px;
      line-height: 1.6;
      font-weight: 600;
    }

    .options-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .option-button {
      background: rgba(255, 255, 255, 0.08);
      border: 2px solid rgba(251, 191, 36, 0.4);
      color: #f8fafc;
      padding: 18px 25px;
      border-radius: 12px;
      font-size: 17px;
      cursor: pointer;
      text-align: left;
      transition: all 0.3s ease;
      font-weight: 500;
    }

    .option-button:hover:not(:disabled) {
      background: rgba(251, 191, 36, 0.15);
      border-color: #fbbf24;
      transform: translateX(10px);
    }

    .option-button:disabled {
      cursor: not-allowed;
    }

    .option-button.correct {
      background: rgba(34, 197, 94, 0.2);
      border-color: #22c55e;
      color: #ffffff;
    }

    .option-button.incorrect {
      background: rgba(239, 68, 68, 0.2);
      border-color: #ef4444;
      color: #ffffff;
    }

    .feedback-message {
      margin-top: 20px;
      padding: 20px;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 600;
      text-align: center;
      display: none;
    }

    .feedback-message.show {
      display: block;
    }

    .feedback-message.correct {
      background: rgba(34, 197, 94, 0.2);
      border: 2px solid #22c55e;
      color: #22c55e;
    }

    .feedback-message.incorrect {
      background: rgba(239, 68, 68, 0.2);
      border: 2px solid #ef4444;
      color: #ef4444;
    }

    .quiz-continue-btn {
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: #0f172a;
      border: none;
      padding: 18px 40px;
      border-radius: 50px;
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      display: block;
      margin: 30px auto 0;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 5px 20px rgba(251, 191, 36, 0.4);
    }

    .quiz-continue-btn:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(251, 191, 36, 0.6);
    }

    /* User Form */
    .user-form-container {
      background: linear-gradient(145deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.98));
      border-radius: 20px;
      padding: 50px;
      border: 3px solid #fbbf24;
      box-shadow: 0 15px 40px rgba(251, 191, 36, 0.4);
      max-width: 600px;
      margin: 0 auto 30px;
      display: none;
    }

    .user-form-container.active {
      display: block;
    }

    .form-title {
      text-align: center;
      font-size: 32px;
      color: #fbbf24;
      margin-bottom: 15px;
      font-weight: 700;
    }

    .form-subtitle {
      text-align: center;
      font-size: 18px;
      color: #cbd5e1;
      margin-bottom: 40px;
    }

    .form-group {
      margin-bottom: 25px;
    }

    .form-label {
      display: block;
      font-size: 16px;
      color: #fbbf24;
      margin-bottom: 10px;
      font-weight: 600;
    }

    .form-input {
      width: 100%;
      padding: 15px 20px;
      border: 2px solid rgba(251, 191, 36, 0.4);
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.08);
      color: #f8fafc;
      font-size: 17px;
      transition: border-color 0.3s ease;
    }

    .form-input:focus {
      outline: none;
      border-color: #fbbf24;
      background: rgba(255, 255, 255, 0.12);
    }

    .form-submit-btn {
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: #0f172a;
      border: none;
      padding: 18px 40px;
      border-radius: 50px;
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      width: 100%;
      margin-top: 20px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 5px 20px rgba(251, 191, 36, 0.4);
    }

    .form-submit-btn:hover:not(:disabled) {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(251, 191, 36, 0.6);
    }

    .form-submit-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Dashboard */
    .dashboard-container {
      display: none;
    }

    .dashboard-container.active {
      display: block;
    }

    .dashboard-header {
      background: linear-gradient(145deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.98));
      border-radius: 20px;
      padding: 50px;
      text-align: center;
      border: 3px solid #fbbf24;
      box-shadow: 0 15px 40px rgba(251, 191, 36, 0.4);
      margin-bottom: 40px;
    }

    .dashboard-title {
      font-size: 36px;
      color: #fbbf24;
      margin-bottom: 20px;
      font-weight: 700;
    }

    .user-name {
      font-size: 28px;
      color: #ffffff;
      margin-bottom: 30px;
      font-weight: 600;
    }

    .score-big {
      font-size: 72px;
      color: #fbbf24;
      font-weight: 700;
      margin: 20px 0;
    }

    .score-label {
      font-size: 24px;
      color: #cbd5e1;
      margin-bottom: 30px;
    }

    .percentage-badge {
      display: inline-block;
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: #0f172a;
      padding: 15px 40px;
      border-radius: 50px;
      font-size: 28px;
      font-weight: 700;
      box-shadow: 0 5px 20px rgba(251, 191, 36, 0.5);
    }



    /* Navigation Controls */
    .navigation-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 20px;
      margin-top: 30px;
    }

    .nav-button {
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: #0f172a;
      border: none;
      padding: 18px 35px;
      border-radius: 50px;
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.3s ease;
      box-shadow: 0 5px 20px rgba(251, 191, 36, 0.4);
    }

    .nav-button:hover:not(:disabled) {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(251, 191, 36, 0.6);
    }

    .nav-button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .nav-icon {
      font-size: 24px;
    }

    .progress-indicator {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      padding: 15px 30px;
      border-radius: 30px;
      font-size: 18px;
      font-weight: 600;
      color: #fbbf24;
      border: 2px solid rgba(251, 191, 36, 0.3);
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(5px);
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal.active {
      display: flex;
      opacity: 1;
      justify-content: center;
      align-items: center;
    }

    .modal-content {
      max-width: 900px;
      width: 90%;
      max-height: 85vh;
      overflow-y: auto;
      padding: 40px;
      border-radius: 20px;
      border: 3px solid #ffbf24;
      backdrop-filter: blur(4px);
    }

    .modal-text {
    margin-top: 20px;
    font-size: 1.2rem;
    line-height: 1.6;
    color: white;
    }

    .modal-close {
      position: absolute;
      top: 20px;
      right: 20px;
      background: #fbbf24;
      color: #0f172a;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s ease, background 0.2s ease;
      font-weight: 700;
    }

    .modal-close:hover {
      background: #f59e0b;
      transform: rotate(90deg);
    }

    .modal-year {
      display: inline-block;
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      color: #0f172a;
      padding: 15px 35px;
      border-radius: 30px;
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 25px;
      box-shadow: 0 5px 20px rgba(251, 191, 36, 0.5);
    }

    .modal-title {
      font-size: 32px;
      color: #ffffff;
      margin-bottom: 25px;
      font-weight: 700;
      line-height: 1.3;
    }

    .modal-text {
      font-size: 18px;
      line-height: 1.8;
      color: #cbd5e1;
      margin-bottom: 20px;
    }

    .modal-highlight {
      background: rgba(251, 191, 36, 0.15);
      border-left: 4px solid #fbbf24;
      padding: 20px;
      margin-top: 25px;
      border-radius: 8px;
      font-style: italic;
      color: #fef3c7;
      font-size: 17px;
      line-height: 1.7;
    }

    .hidden {
      display: none;
    }

    @media (max-width: 768px) {
      .score-display {
        top: 10px;
        right: 10px;
        padding: 12px 20px;
        font-size: 16px;
      }

      .header h1 {
        font-size: 28px;
      }

      .header .subtitle {
        font-size: 16px;
      }

      .anchor-icon {
        font-size: 28px;
      }

      .characters-section {
        padding: 25px;
      }

      .characters-title {
        font-size: 24px;
      }

      .characters-grid {
        grid-template-columns: 1fr;
      }

      .timeline-section-title {
        font-size: 26px;
      }

      .timeline-card {
        padding: 30px;
      }

      .card-year {
        font-size: 20px;
        padding: 10px 20px;
      }

      .card-title {
        font-size: 22px;
      }

      .card-content {
        font-size: 15px;
      }

      .card-highlight {
        font-size: 14px;
        padding: 15px;
      }

      .card-icon {
        font-size: 35px;
        top: 30px;
        right: 30px;
      }

      .quiz-container {
        padding: 30px 20px;
      }

      .quiz-title {
        font-size: 26px;
      }

      .question-text {
        font-size: 18px;
      }

      .option-button {
        padding: 15px 20px;
        font-size: 16px;
      }

      .user-form-container {
        padding: 30px 20px;
      }

      .form-title {
        font-size: 26px;
      }

      .dashboard-header {
        padding: 30px 20px;
      }

      .dashboard-title {
        font-size: 28px;
      }

      .user-name {
        font-size: 24px;
      }

      .score-big {
        font-size: 56px;
      }

      .score-label {
        font-size: 20px;
      }

      .percentage-badge {
        font-size: 24px;
        padding: 12px 30px;
      }

      .ranking-section {
        padding: 25px 15px;
      }

      .navigation-controls {
        flex-direction: column;
      }

      .nav-button {
        width: 100%;
        justify-content: center;
        padding: 15px 25px;
        font-size: 16px;
      }

      .progress-indicator {
        width: 100%;
        text-align: center;
      }

      .modal-content {
        padding: 30px;
        width: 95%;
      }

      .modal-year {
        font-size: 24px;
        padding: 12px 25px;
      }

      .modal-title {
        font-size: 24px;
      }

      .modal-text {
        font-size: 16px;
      }
    }

/* Contenedor del video */
#introVideoSection {
    width: 100%;
    padding-top: 50px;  /* separaci√≥n desde arriba */
    padding-bottom: 40px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;  /* CENTRA EL VIDEO HORIZONTALMENTE */
}

/* Tama√±o del video */
#introVideoSection video {
    width: 60%;        /* ajusta tama√±o */
    max-width: 900px;  /* l√≠mite para pantallas grandes */
    border-radius: 15px;
    box-shadow: 0 10px 35px rgba(0,0,0,0.6);
}

/* Bot√≥n debajo del video */
#introVideoSection .nav-button {
    margin-top: 20px;
}

    
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>

<body>
    <script src="scorm_api.js"></script>
    <script>
        // Inicializar SCORM
        let API = null;

        function getAPI() {
            if (API) return API;
            if (window.parent && window.parent.API) API = window.parent.API;
            if (!API && window.opener && window.opener.API) API = window.opener.API;
            return API;
        }

        function iniciarSCORM() {
            const api = getAPI();
            if (api) api.LMSInitialize("");
        }

        // Ejecutar SCORM al cargar
        window.onload = iniciarSCORM;
    </script>

  <div class="score-display" id="scoreDisplay">
   üèÜ Puntaje: <span id="scoreValue">0</span>/8
  </div>

    <!-- üîµ PANTALLA DE PUNTAJE -->
    <div class="score-display" id="scoreDisplay">
        üèÜ Puntaje: <span id="scoreValue">0</span>/8
    </div>

  <main>
   <div class="container">
    <header class="header">
     <h1 id="main-title"><span class="anchor-icon">‚öì</span>Escuela Naval de Cadetes "Almirante Padilla"</h1>
     <div class="subtitle" id="subtitle">
      L√≠nea de Tiempo Hist√≥rica Interactiva
     </div>
    </header><!-- Characters Section -->
    <section class="characters-section" id="charactersSection">
     <div class="characters-title">
      ‚≠ê Personajes Emblem√°ticos ‚≠ê
     </div>
     <div class="characters-grid">
      <div class="character-card" onclick="showCharacterModal('binney')">
       <div class="character-icon">
        üéñÔ∏è
       </div>
       <div class="character-name">
        Ralph Douglas Binney
       </div>
       <div class="character-role">
        Fundador y Primer Director
       </div>
       <div class="character-year">
        1935
       </div>
      </div>
      <div class="character-card" onclick="showCharacterModal('padilla')">
       <div class="character-icon">
        ‚öì
       </div>
       <div class="character-name">
        Almirante Jose Padilla Lopez
       </div>
       <div class="character-role">
        H√©roe Naval - Homenajeado
       </div>
       <div class="character-year">
        1774-1829
       </div>
      </div>
      <div class="character-card" onclick="showCharacterModal('bascope')">
       <div class="character-icon">
        üåä
       </div>
       <div class="character-name">
        Juan Bascop√© Guzm√°n
       </div>
       <div class="character-role">
        Misi√≥n Chilena - Oficiales Mercantes
       </div>
       <div class="character-year">
        D√©cada 1950
       </div>
      </div>
     </div>

    <!-- üîµ INTRO VIDEO (PASO 1 VA EXACTAMENTE AQU√ç) -->
    <section id="introVideoSection" class="video-container">
        <video id="introVideo" width="55%" controls style="border-radius:15px;">
    <source src="./Disciplina_del_cadete.mp4" type="video/mp4">
</video>


        <button class="nav-button" onclick="startTimeline()">
            Continuar
        </button>
    </section>

    </section><!-- Timeline Section -->
    <section id="timelineSection" style="display:none;">
     <h2 class="timeline-section-title">üìú Historia Cronol√≥gica</h2>
     <div class="timeline-single-card">
      <article class="timeline-card" id="currentCard">
       <div class="card-icon" id="cardIcon">
        üìö
       </div>
       <div class="card-year" id="cardYear">
        1822
       </div>
       <h3 class="card-title" id="cardTitle">Primera Escuela N√°utica</h3>
       <p class="card-content" id="cardContent">Se estableci√≥ la Escuela N√°utica en Cartagena...</p>
       <div class="card-highlight visible" id="cardHighlight">
        Los primeros intentos...
       </div>
      </article>
      <div class="navigation-controls">
       <div class="progress-indicator"><span id="currentIndex">1</span> de <span id="totalEvents">20</span>
       </div><button class="nav-button" id="nextBtn" onclick="navigateTimeline('next')"> <span class="nav-text">Siguiente</span> <span class="nav-icon">‚õµ</span> </button>
      </div>
     </div>
    </section><!-- Quiz Section -->
    <section class="quiz-container" id="quizSection">
     <div class="quiz-header">
      <div class="quiz-title">
       üéØ ¬°Momento de Evaluaci√≥n!
      </div>
      <div class="quiz-subtitle">
       Responde estas preguntas sobre la historia naval
      </div>
      <div class="quiz-progress">
       Pregunta <span id="quizProgress">1</span> de 2
      </div>
     </div>
     <div id="questionsContainer"></div><button class="quiz-continue-btn" id="continueBtn" onclick="continueFromQuiz()" style="display: none;"> Continuar con la Historia ‚öì </button>
    </section><!-- User Form Section -->
    <section class="user-form-container" id="userFormSection">
     <div class="form-title">
      üéì ¬°Felicitaciones!
     </div>
     <div class="form-subtitle">
      Has completado el recorrido hist√≥rico. Ingresa tus datos para guardar tu resultado.
     </div>
     <form id="userForm" onsubmit="submitUserData(event)">
      <div class="form-group"><label for="nombreInput" class="form-label">Nombre</label> <input type="text" id="nombreInput" class="form-input" placeholder="Tu nombre" required>
      </div>
      <div class="form-group"><label for="apellidoInput" class="form-label">Apellido</label> <input type="text" id="apellidoInput" class="form-input" placeholder="Tu apellido" required>
      </div><button type="submit" class="form-submit-btn" id="submitBtn"> Ver Mis Resultados üèÜ </button>
     </form>
    </section><!-- Dashboard Section -->
    <section class="dashboard-container" id="dashboardSection">
     <div class="dashboard-header">
      <div class="dashboard-title">
       üéñÔ∏è Resultados Finales
      </div>
      <div class="user-name" id="dashboardUserName">
       Usuario
      </div>
      <div class="score-big" id="dashboardScore">
       0
      </div>
      <div class="score-label">
       de 5 preguntas correctas
      </div>
      <div class="percentage-badge" id="dashboardPercentage">
       0%
      </div><button class="nav-button" onclick="restartTimeline()" style="margin-top: 30px; display: inline-flex;"> <span class="nav-icon">‚Ü∫</span> <span class="nav-text">Volver al Inicio</span> </button>
     </div>
     <div class="ranking-section">
      <div class="ranking-title">
                  Ranking de Participantes
      </div>
      <div class="ranking-list" id="rankingList"></div>
     </div>
    </section>
   </div>
  </main><!-- Modal -->
  <div class="modal" id="eventModal" onclick="closeModal(event)">
   <div class="modal-content" onclick="event.stopPropagation()"><button class="modal-close" onclick="closeModal(event)">√ó</button>
    <div id="modalContent"></div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      main_title: "Escuela Naval de Cadetes \"Almirante Padilla\"",
      subtitle: "L√≠nea de Tiempo Hist√≥rica Interactiva",
      primary_color: "#0f172a",
      secondary_color: "#1e293b",
      text_color: "#f8fafc",
      accent_color: "#fbbf24",
      button_color: "#f59e0b",
      font_family: "Segoe UI",
      font_size: 16
    };

    let config = { ...defaultConfig };
    let currentEventIndex = 0;
    let userScore = 0;
    let totalQuestions = 5;
    let currentQuizQuestions = [];
    let currentQuestionIndex = 0;
    let allUserRecords = [];

    const timelineEvents = [
      {
        icon: 'üèõÔ∏è',
        year: 'Siglos XVII-XVIII',
        title: 'Or√≠genes Coloniales',
        content: 'Durante el periodo colonial surgi√≥ la necesidad de formar personal capacitado para la defensa mar√≠tima del Virreinato de la Nueva Granada. Se registraron varios intentos motivados por amenazas externas, pirater√≠a en el Caribe y la importancia estrat√©gica de Cartagena de Indias.',
        highlight: 'Los primeros esfuerzos de educaci√≥n n√°utica en territorio colombiano durante la √©poca colonial.'
      },
      {
        icon: 'üìö',
        year: '1822',
        title: 'Escuela N√°utica de Cartagena',
        content: 'Se funda la Escuela N√°utica de Cartagena, adscrita a la Universidad del Magdalena e Istmo. Logr√≥ graduar dos promociones, pero problemas econ√≥micos impidieron su continuidad.',
        highlight: 'Primer intento formal de educaci√≥n naval en la Colombia independiente.'
      },
      {
        icon: '      ',
        year: '1866',
        title: 'Anexo al Colegio de Bol√≠var',
        content: 'La Escuela N√°utica se restablece como anexo al Colegio de Bol√≠var (hoy Universidad de Cartagena), pero nuevamente no prosper√≥ debido a limitaciones presupuestales y operativas.',
        highlight: 'Estos primeros esfuerzos demostraron la necesidad de una instituci√≥n permanente dedicada a la formaci√≥n naval.'
      },
      {
        icon: 'üö¢',
        year: '1907-1909',
        title: 'Escuela Naval Nacional',
        content: 'Se crea la Escuela Naval Nacional a principios del siglo XX, que logr√≥ graduar un solo curso de oficiales en 1909 antes de cesar operaciones.',
        highlight: null
      },
      {
        icon: '‚öîÔ∏è',
        year: '1932-1933',
        title: 'Conflicto con Per√∫',
        content: 'Tras el conflicto con el Per√∫ se evidenci√≥ la necesidad urgente de contar con una marina moderna y una escuela naval s√≥lida que formara personal capacitado en navegaci√≥n, artiller√≠a, ingenier√≠a y mando naval.',
        highlight: 'El pa√≠s comprendi√≥ que sin educaci√≥n mar√≠tima no habr√≠a desarrollo naval.'
      },
      {
        icon: '‚öì',
        year: '13 de Abril de 1935',
        title: 'Fundaci√≥n Oficial',
        content: 'Mediante el Decreto 712 se fund√≥ la Escuela Naval de Cadetes, bajo la direcci√≥n del Capit√°n de Nav√≠o ingl√©s Ralph Douglas Binney. Funcion√≥ inicialmente a bordo del MC "C√∫cuta", fondeado en Cartagena. El 3 de julio inici√≥ actividades el primer contingente.',
        highlight: 'Los Cadetes fueron seleccionados de a dos por departamento. Esta etapa sent√≥ las bases doctrinales, √©ticas y formativas que a√∫n perduran.'
      },
      {
        icon: 'üèñÔ∏è',
        year: '1938',
        title: 'Traslado a Bocagrande',
        content: 'Tres a√±os despu√©s de su fundaci√≥n, la Escuela se traslad√≥ a instalaciones en Bocagrande, donde permaneci√≥ durante m√°s de dos d√©cadas. All√≠ se consolidaron los primeros planes curriculares modernos y la formalizaci√≥n de los Cuerpos: L√≠nea, Infanter√≠a de Marina y Administrativo.',
        highlight: 'Se crearon unidades auxiliares de instrucci√≥n: veleros, buques menores, talleres y aulas de armas.'
      },
      {
        icon: 'üö¢',
        year: '1947',
        title: 'ARC "Almirante Padilla"',
        content: 'El gobierno adquiri√≥ la fragata ARC "Almirante Padilla" como primer buque escuela formal. Se fortalecieron las pr√°cticas de navegaci√≥n, artiller√≠a, maniobra y guardias en el mar.',
        highlight: 'La instrucci√≥n a bordo se convirti√≥ en el sello distintivo de la formaci√≥n naval colombiana.'
      },
      {
        icon: 'üåé',
        year: 'D√©cada de 1950',
        title: 'Expansi√≥n Acad√©mica',
        content: 'Se estableci√≥ un programa de formaci√≥n de Oficiales de la Flota Mercante para la antigua Flota Grancolombiana, con asesor√≠a chilena liderada por Juan Bascop√© Guzm√°n. Iniciaron env√≠os de cadetes a Estados Unidos, Chile, Italia, Suecia y Reino Unido.',
        highlight: 'Fortalecimiento del intercambio doctrinal naval internacional y movilidad acad√©mica.'
      },
      {
        icon: 'üéñÔ∏è',
        year: '1958',
        title: 'Infanter√≠a de Marina',
        content: 'La Escuela gradu√≥ al primer curso de Oficiales de Infanter√≠a de Marina, consolidando este cuerpo como brazo fundamental de la Armada de Colombia.',
        highlight: 'Primera promoci√≥n de Oficiales de Infanter√≠a de Marina.'
      },
      {
        icon: 'üèùÔ∏è',
        year: '1961',
        title: 'Isla de Manzanillo',
        content: 'La Escuela Naval se instal√≥ definitivamente en la Isla de Manzanillo, su actual sede permanente. Este lugar fue elegido por su aislamiento natural, que fomenta disciplina naval, vida en r√©gimen militar y entrenamiento cercano al mar.',
        highlight: 'Desde aqu√≠ la ENAP creci√≥ acad√©mica, tecnol√≥gica y operativamente por m√°s de seis d√©cadas.'
      },
      {
        icon: '               ',
        year: '1964',
        title: 'Ingenier√≠a Naval',
        content: 'Se incorpor√≥ la ense√±anza cient√≠fica y tecnol√≥gica con enfoque naval. Inici√≥ el programa de Ingenier√≠a Naval, expediendo los primeros t√≠tulos profesionales en esta especialidad.',
        highlight: 'Inicio de la transformaci√≥n acad√©mica hacia una instituci√≥n de educaci√≥n superior.'
      },
      {
        icon: '‚õµ',
        year: '1968',
        title: 'ARC "Gloria"',
        content: 'El gobierno adquiri√≥ el buque ARC "Gloria", que se convirti√≥ en el embajador flotante de Colombia ante el mundo. Los cadetes realizan un semestre acad√©mico a bordo, fortaleciendo liderazgo, navegaci√≥n astron√≥mica, guardias marineras y trabajo en equipo.',
        highlight: 'El ARC "Gloria" recorre el mundo representando a Colombia en puertos internacionales.'
      },
      {
        icon: 'üéì',
        year: '1974',
        title: 'Cambio de Denominaci√≥n',
        content: 'La instituci√≥n cambi√≥ su denominaci√≥n oficial a Escuela Naval de Cadetes "Almirante Padilla" en honor al h√©roe naval colombiano Jose Padilla Lopez, vencedor de la Batalla Naval del Lago de Maracaibo.',
        highlight: null
      },
      {
        icon: 'üèõÔ∏è',
        year: '20 de Octubre de 1977',
        title: 'Reconocimiento Universitario',
        content: 'Mediante Resoluci√≥n 11893, el Ministerio de Educaci√≥n Nacional otorg√≥ reconocimiento como Universidad, convirti√©ndola en la √∫nica Instituci√≥n de Educaci√≥n Superior del sector naval-militar con este car√°cter. Se crearon las Facultades de Ingenier√≠a Naval, Oceanograf√≠a y Administraci√≥n Mar√≠tima.',
        highlight: 'La ENAP se convierte en Universidad, √∫nica en el sector Defensa con este car√°cter.'
      },
      {
        icon: 'üë©‚Äç‚úàÔ∏è',
        year: '1984',
        title: 'La Mujer en la Marina',
        content: 'La Escuela Naval gradu√≥ el primer contingente de mujeres Oficiales del Cuerpo Administrativo, marcando un paso hist√≥rico hacia la diversidad e inclusi√≥n en la instituci√≥n naval colombiana.',
        highlight: 'Incorporaci√≥n pionera de la mujer en la formaci√≥n naval militar.'
      },
      {
        icon: 'üìñ',
        year: '1992-2007',
        title: 'Programas de Posgrado',
        content: 'En 1992 se iniciaron programas de especializaciones. En 2007 se inauguraron las primeras maestr√≠as en √°reas mar√≠timas y navales, consolidando la oferta acad√©mica de posgrado.',
        highlight: 'Fortalecimiento del CIOH y creaci√≥n de programas avanzados de investigaci√≥n.'
      },
      {
        icon: 'üë©‚Äç‚úàÔ∏è',
        year: '1997',
        title: 'Mujeres Oficiales de L√≠nea',
        content: 'Se recibi√≥ al primer grupo de mujeres para formarse como Oficiales de L√≠nea. Actualmente ejercen comando de unidades a flote, navegaci√≥n, ingenier√≠a, Infanter√≠a de Marina y participan en misiones internacionales.',
        highlight: 'La ENAP es pionera en equidad militar en la regi√≥n.'
      },
      {
        icon: 'üî¨',
        year: '2015',
        title: 'Modernizaci√≥n - Proyecto Alfa Sextantis',
        content: 'Se impuls√≥ la modernizaci√≥n con el proyecto Alfa Sextantis, transformando laboratorios, aulas y zonas de bienestar. Se puso en funcionamiento el CIDIAM (Centro de Investigaci√≥n para Actividades Mar√≠timas), consolidando capacidades para investigaci√≥n en simulaci√≥n naval e innovaci√≥n tecnol√≥gica.',
        highlight: 'Salto tecnol√≥gico con simuladores e infraestructura de investigaci√≥n de clase mundial.'
      },
      {
        icon: 'üèÜ',
        year: '2017-2024',
        title: 'Excelencia Acad√©mica',
        content: 'En 2017 obtuvo Acreditaci√≥n Institucional en Alta Calidad por 6 a√±os. En 2019 se cre√≥ la Facultad de Marina Mercante. En 2020 se autoriz√≥ el Doctorado Interinstitucional en Ciencias del Mar, primer doctorado del sector Defensa. En 2024 renov√≥ la Acreditaci√≥n en Alta Calidad por 8 a√±os.',
        highlight: 'La ENAP se posiciona entre las mejores instituciones de educaci√≥n superior de Colombia y como cl√∫ster de educaci√≥n mar√≠tima internacional en el Caribe.'
      }
    ];

    const allQuestions = [
      {
        question: "¬øCu√°l fue la principal motivaci√≥n para la creaci√≥n de la Escuela Naval de Cadetes \"Almirante Padilla\" en 1935?",
        options: [
          "Formar navegantes comerciales para la marina mercante",
          "Desarrollar oficiales capaces de fortalecer la naciente Armada Nacional",
          "Reemplazar academias militares del interior del pa√≠s",
          "Capacitar personal civil en operaciones mar√≠timas"
        ],
        correct: 1
      },
      {
        question: "¬øQu√© ocurri√≥ en 2024 seg√∫n la rese√±a hist√≥rica?",
        options: [
          "La escuela cerr√≥ temporalmente",
          "Se renov√≥ la Acreditaci√≥n en Alta Calidad Institucional por 8 a√±os",
          "Se inaugur√≥ una nueva facultad de Derecho Mar√≠timo",
          "Se cambi√≥ de sede"
        ],
        correct: 1
      },
      {
        question: "¬øEn qu√© siglo hubo intentos por establecer una escuela naval en Colombia seg√∫n la rese√±a hist√≥rica?",
        options: [
          "Siglo XIX",
          "Siglo XVIII",
          "Siglo XVII",
          "Siglo XX"
        ],
        correct: 2
      },
      {
        question: "¬øQu√© ocurri√≥ en 1822 en la historia de la formaci√≥n naval en Cartagena?",
        options: [
          "Se construy√≥ un astillero naval",
          "Se cre√≥ la Escuela N√°utica incorporada a la Universidad del Magdalena",
          "Se inaugur√≥ el primer buque escuela",
          "Se firm√≥ un tratado naval"
        ],
        correct: 1
      },
      {
        question: "¬øCu√°l fue el resultado del primer intento de la Escuela N√°utica de 1822?",
        options: [
          "Se consolid√≥ durante d√©cadas",
          "Nunca gradu√≥ estudiantes",
          "Gradu√≥ dos promociones, pero no pudo continuar operando",
          "Se fusion√≥ con la Armada"
        ],
        correct: 2
      },
      {
        question: "¬øQu√© pas√≥ en 1866 con relaci√≥n a la educaci√≥n naval?",
        options: [
          "Se fund√≥ una nueva Armada",
          "Se reabri√≥ la Escuela N√°utica como anexo de la Universidad de Cartagena",
          "Se compr√≥ un nuevo buque escuela",
          "Se cre√≥ un programa de posgrado"
        ],
        correct: 1
      },
      {
        question: "¬øPor qu√© el intento de 1866 \"no tuvo acogida\"?",
        options: [
          "Por falta de estudiantes",
          "Por problemas financieros",
          "Porque no gener√≥ suficiente inter√©s",
          "Porque la Armada dej√≥ de existir"
        ],
        correct: 2
      },
      {
        question: "¬øQu√© instituci√≥n se cre√≥ en la primera d√©cada del siglo XX?",
        options: [
          "Universidad Mar√≠tima Internacional",
          "Escuela Naval Nacional",
          "Academia de Suboficiales",
          "Escuela de Infanter√≠a de Marina"
        ],
        correct: 1
      },
      {
        question: "¬øCu√°ntos cursos de oficiales gradu√≥ la Escuela Naval Nacional antes de cerrar?",
        options: [
          "Uno",
          "Dos",
          "Tres",
          "Ninguno"
        ],
        correct: 0
      },
      {
        question: "¬øEn qu√© a√±o fue creada oficialmente la Escuela Naval de Cadetes \"Almirante Padilla\"?",
        options: [
          "1925",
          "1935",
          "1945",
          "1955"
        ],
        correct: 1
      },
      {
        question: "¬øCu√°l fue el decreto que cre√≥ la escuela en 1935?",
        options: [
          "Decreto 500",
          "Decreto 712",
          "Decreto 1023",
          "Decreto 1500"
        ],
        correct: 1
      },
      {
        question: "¬øD√≥nde iniciaron sus labores los cadetes en 1935?",
        options: [
          "En tierra firme en Cartagena",
          "A bordo del MC C√∫cuta",
          "En Bogot√°",
          "En Barranquilla"
        ],
        correct: 1
      },
      {
        question: "¬øC√≥mo se seleccion√≥ el primer contingente de cadetes?",
        options: [
          "Por examen f√≠sico solamente",
          "Por sorteo departamental (\"de a dos por departamento\")",
          "Por recomendaci√≥n pol√≠tica",
          "Por experiencia mar√≠tima previa"
        ],
        correct: 1
      },
      {
        question: "¬øCu√°ndo la escuela se traslad√≥ a tierra por primera vez?",
        options: [
          "1936",
          "1938",
          "1945",
          "1961"
        ],
        correct: 1
      },
      {
        question: "¬øA qu√© lugar se traslad√≥ la escuela en 1961?",
        options: [
          "Bocagrande",
          "Isla de Manzanillo",
          "Isla de San Andr√©s",
          "Cartagena viejo"
        ],
        correct: 1
      },
      {
        question: "¬øQu√© cambio importante ocurri√≥ en la d√©cada de los 50?",
        options: [
          "Se cerr√≥ la escuela",
          "Diversificaci√≥n de la formaci√≥n: se inici√≥ la formaci√≥n de oficiales mercantes y de infanter√≠a de marina",
          "Se traslad√≥ a otra ciudad",
          "Se convirti√≥ en escuela de suboficiales"
        ],
        correct: 1
      },
      {
        question: "¬øQu√© misi√≥n extranjera apoy√≥ la formaci√≥n naval en los a√±os 50?",
        options: [
          "Misi√≥n estadounidense",
          "Misi√≥n brit√°nica",
          "Misi√≥n chilena",
          "Misi√≥n francesa"
        ],
        correct: 2
      },
      {
        question: "¬øCu√°ndo se gradu√≥ la primera promoci√≥n de oficiales de Infanter√≠a de Marina?",
        options: [
          "1955",
          "1958",
          "1960",
          "1965"
        ],
        correct: 1
      },
      {
        question: "La \"movilidad acad√©mica saliente\" en los a√±os 50 se refiere a:",
        options: [
          "Cadetes que cambiaban de facultad dentro de la escuela",
          "Env√≠o de cadetes a escuelas navales extranjeras (EE.UU., Chile, Italia, Suecia)",
          "Intercambios entre universidades colombianas",
          "Reclutamiento de oficiales extranjeros"
        ],
        correct: 1
      },
      {
        question: "¬øQu√© buque compr√≥ el gobierno en 1947 para entrenamiento naval?",
        options: [
          "ARC \"Gloria\"",
          "ARC \"Almirante Padilla\" fragata",
          "ARC \"Bol√≠var\"",
          "ARC \"Cartagena\""
        ],
        correct: 1
      },
      {
        question: "¬øQu√© buque escuela adquirido en 1968 es s√≠mbolo de la escuela?",
        options: [
          "ARC \"Padilla II\"",
          "ARC \"Libertador\"",
          "ARC \"Gloria\"",
          "ARC \"Independiente\""
        ],
        correct: 2
      },
      {
        question: "¬øCu√°l es la funci√≥n del buque ARC \"Gloria\" en la formaci√≥n?",
        options: [
          "Transporte de mercanc√≠as",
          "Buque de guerra activo",
          "Herramienta para pr√°cticas navales con cadetes (semestre a bordo)",
          "Escuela en tierra"
        ],
        correct: 2
      },
      {
        question: "¬øEn qu√© a√±o se gradu√≥ el primer contingente de mujeres oficiales del Cuerpo Administrativo?",
        options: [
          "1974",
          "1980",
          "1984",
          "1990"
        ],
        correct: 2
      },
      {
        question: "¬øCu√°ndo ingres√≥ el primer grupo de mujeres como oficiales de l√≠nea?",
        options: [
          "1984",
          "1990",
          "1997",
          "2000"
        ],
        correct: 2
      },
      {
        question: "¬øEn qu√© a√±o la escuela empez√≥ a otorgar t√≠tulos universitarios de Ingenier√≠a Naval?",
        options: [
          "1950",
          "1964",
          "1970",
          "1977"
        ],
        correct: 1
      },
      {
        question: "¬øQu√© resoluci√≥n del Ministerio de Educaci√≥n reconoci√≥ a la Escuela Naval como universidad?",
        options: [
          "Resoluci√≥n 10000",
          "Resoluci√≥n 11893",
          "Resoluci√≥n 24403",
          "Resoluci√≥n 007469"
        ],
        correct: 1
      },
      {
        question: "¬øEn qu√© a√±o recibi√≥ ese reconocimiento universitario?",
        options: [
          "1964",
          "1974",
          "1977",
          "1980"
        ],
        correct: 2
      },
      {
        question: "¬øCu√°ndo se empez√≥ a ofrecer posgrados (especializaciones) seg√∫n la rese√±a?",
        options: [
          "1950",
          "1977",
          "1992",
          "2000"
        ],
        correct: 2
      },
      {
        question: "¬øQu√© proyecto de modernizaci√≥n empez√≥ en 2015?",
        options: [
          "Construcci√≥n de un nuevo buque escuela",
          "Proyecto Alfa Sextantis y el Centro de Investigaci√≥n, Desarrollo e Innovaci√≥n Mar√≠tima",
          "Apertura de un campus en Bogot√°",
          "Creaci√≥n de nuevos pregrados"
        ],
        correct: 1
      },
      {
        question: "¬øEn qu√© a√±o la Escuela Naval obtuvo su primera Acreditaci√≥n Institucional alta calidad?",
        options: [
          "2010",
          "2017",
          "2020",
          "2024"
        ],
        correct: 1
      }
    ];

    const characterData = {

  binney: {
    name: "Capit√°n de Nav√≠o Ralph Douglas Binney",
    year: "1935",
    role: "Fundador y Primer Director",
    image: "RALPH_BINNEY.jpg",   // Pon la ruta que usabas
    position: "center 25%",
    content: `
      Oficial de la Marina Real Brit√°nica, enviado a Colombia para apoyar la formaci√≥n mar√≠tima 
      del pa√≠s. Se desempe√±√≥ como primer Director de la Escuela Naval de Cadetes y fue responsable 
      de establecer las bases acad√©micas, disciplinares y doctrinales de la instituci√≥n, 
      influyendo significativamente en el modelo de ense√±anza naval colombiano.
    `
  },

  padilla: {
    name: "Almirante Jos√© Padilla L√≥pez",
    year: "1774‚Äì1829",
    role: "H√©roe Naval ‚Äì Homenajeado",
    image: "ALM_JOSE_PADILLA.jpg",  // Pon la ruta que usabas
    position: "center center",
    content: `
      M√°ximo referente del Poder Naval en Colombia. Protagonista de la hist√≥rica 
      <strong>Batalla del Lago de Maracaibo (1823)</strong>, victoria decisiva que garantiz√≥ 
      la independencia definitiva de la Nueva Granada. Su liderazgo t√°ctico, valent√≠a 
      y capacidad estrat√©gica lo convierten en la figura m√°s influyente de la historia 
      naval colombiana.  
      <br>
      Su legado vive en cada generaci√≥n de oficiales de la Armada Nacional.
    `
  },

  bascope: {
    name: "Juan Bascop√© Guzm√°n",
    year: "D√©cada de 1950",
    role: "Misi√≥n Chilena ‚Äì Oficiales Mercantes",
    image: "SALUDO_BASCOP√â.jpg",   // Pon la ruta que usabas
    position: "center center",
    content: `
      Oficial chileno que integr√≥ la misi√≥n extranjera enviada para fortalecer 
      la formaci√≥n de los cadetes mercantes y navales colombianos. Su labor pedag√≥gica, 
      experiencia internacional y disciplina marcaron una √©poca importante para el 
      desarrollo profesional mar√≠timo del pa√≠s.  
      <br>
      Contribuy√≥ directamente a la modernizaci√≥n del sistema de instrucci√≥n naval.
    `
  }

};



    function getRandomQuestions(count) {
      const shuffled = [...allQuestions].sort(() => Math.random() - 0.5);
      return shuffled.slice(0, count);
    }

    function updateCard() {
      const event = timelineEvents[currentEventIndex];
      
      document.getElementById('cardIcon').textContent = event.icon;
      document.getElementById('cardYear').textContent = event.year;
      document.getElementById('cardTitle').textContent = event.title;
      document.getElementById('cardContent').textContent = event.content;
      
      const highlightEl = document.getElementById('cardHighlight');
      if (event.highlight) {
        highlightEl.textContent = event.highlight;
        highlightEl.classList.add('visible');
      } else {
        highlightEl.classList.remove('visible');
      }
      
      document.getElementById('currentIndex').textContent = currentEventIndex + 1;
      
      // Never disable the button - we need it after event 20
      document.getElementById('nextBtn').disabled = false;
    }

    function navigateTimeline(direction) {

    // --- 1. QUIZ FINAL (evento 20 index 19)
    if (currentEventIndex === 19) {
        showQuiz(true);
        return;
    }

    // --- 2. QUIZ CADA 4 EVENTOS (4, 8, 12, 16)
    if (
        currentEventIndex !== 0 &&        
        (currentEventIndex + 1) % 4 === 0 &&
        currentEventIndex < 19
    ) {
        showQuiz(false);
        return;
    }

    // --- 3. AVANZAR NORMALMENTE
    if (direction === "next") {
        currentEventIndex++;

        // evitar error al llegar al final
        if (currentEventIndex > timelineEvents.length - 1) {
            currentEventIndex = timelineEvents.length - 1;
        }

    } else if (direction === "prev") {
        currentEventIndex--;

        if (currentEventIndex < 0) {
            currentEventIndex = 0;
        }
    }

    updateCard();
}




    let isFinalQuiz = false;

    function showQuiz(finalQuiz = false) {
      isFinalQuiz = finalQuiz;
      currentQuizQuestions = getRandomQuestions(1);
      currentQuestionIndex = 0;

      document.getElementById('timelineSection').style.display = 'none';
      document.getElementById('quizSection').classList.add('active');
      document.getElementById('charactersSection').style.display = 'none';

      renderQuizQuestions();
    }

    function renderQuizQuestions() {
      const container = document.getElementById('questionsContainer');
      container.innerHTML = '';

      currentQuizQuestions.forEach((q, qIndex) => {
        const questionCard = document.createElement('div');
        questionCard.className = 'question-card';
        questionCard.id = `question-${qIndex}`;

        const questionText = document.createElement('div');
        questionText.className = 'question-text';
        questionText.textContent = `${qIndex + 1}. ${q.question}`;

        const optionsContainer = document.createElement('div');
        optionsContainer.className = 'options-container';

        q.options.forEach((option, optIndex) => {
          const optionBtn = document.createElement('button');
          optionBtn.className = 'option-button';
          optionBtn.textContent = option;
          optionBtn.onclick = () => handleAnswer(qIndex, optIndex);
          optionBtn.id = `option-${qIndex}-${optIndex}`;
          optionsContainer.appendChild(optionBtn);
        });

        const feedback = document.createElement('div');
        feedback.className = 'feedback-message';
        feedback.id = `feedback-${qIndex}`;

        questionCard.appendChild(questionText);
        questionCard.appendChild(optionsContainer);
        questionCard.appendChild(feedback);
        container.appendChild(questionCard);
      });

      document.getElementById('quizProgress').textContent = '1-2';
    }

    let answeredQuestions = new Set();

    function handleAnswer(questionIndex, selectedOption) {
      if (answeredQuestions.has(questionIndex)) return;

      const question = currentQuizQuestions[questionIndex];
      const isCorrect = selectedOption === question.correct;
      
      answeredQuestions.add(questionIndex);
      
      if (isCorrect) {
        userScore++;
        document.getElementById('scoreValue').textContent = userScore;
      }

      // Disable all options for this question
      for (let i = 0; i < question.options.length; i++) {
        const optionBtn = document.getElementById(`option-${questionIndex}-${i}`);
        optionBtn.disabled = true;
        
        if (i === question.correct) {
          optionBtn.classList.add('correct');
        } else if (i === selectedOption && !isCorrect) {
          optionBtn.classList.add('incorrect');
        }
      }

      // Show feedback
      const feedback = document.getElementById(`feedback-${questionIndex}`);
      feedback.classList.add('show');
      feedback.classList.add(isCorrect ? 'correct' : 'incorrect');
      feedback.textContent = isCorrect ? '‚úÖ ¬°Correcto! Excelente conocimiento naval.' : '‚ùå Incorrecto. La respuesta correcta se muestra en verde.';

      // Show continue button when all questions answered
      if (answeredQuestions.size === currentQuizQuestions.length) {
        document.getElementById('continueBtn').style.display = 'block';
      }
    }

    function continueFromQuiz() {
      answeredQuestions.clear();
      document.getElementById('quizSection').classList.remove('active');
      document.getElementById('continueBtn').style.display = 'none';
      
      // If this was the final quiz (after event 20), show user form
      if (isFinalQuiz) {
        document.getElementById('userFormSection').classList.add('active');
        document.getElementById('charactersSection').style.display = 'none';
        isFinalQuiz = false;
      } else {
        // Move to next event and show timeline
        currentEventIndex++;
        updateCard();
        document.getElementById('timelineSection').style.display = 'block';
        document.getElementById('charactersSection').style.display = 'block';
      }
    }

    async function submitUserData(event) {
      event.preventDefault();

      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'Guardando...';

      const nombre = document.getElementById('nombreInput').value.trim();
      const apellido = document.getElementById('apellidoInput').value.trim();
      const porcentaje = Math.round((userScore / totalQuestions) * 100);

      const userData = {
        nombre: nombre,
        apellido: apellido,
        puntaje: userScore,
        total_preguntas: totalQuestions,
        porcentaje: porcentaje,
        fecha: new Date().toISOString()
      };

      if (window.dataSdk) {
        const result = await window.dataSdk.create(userData);
        
        if (result.isOk) {
          // Wait longer for data to sync
          setTimeout(() => {
            showDashboard(nombre, apellido, userScore, porcentaje);
          }, 1200);
        } else {
          submitBtn.disabled = false;
          submitBtn.textContent = 'Ver Mis Resultados üèÜ';
          
          const feedbackDiv = document.createElement('div');
          feedbackDiv.className = 'feedback-message show incorrect';
          feedbackDiv.style.marginTop = '20px';
          feedbackDiv.textContent = 'Error al guardar los datos. Por favor intenta nuevamente.';
          document.getElementById('userForm').appendChild(feedbackDiv);
          
          setTimeout(() => feedbackDiv.remove(), 3000);
        }
      } else {
        // If SDK not available, show dashboard anyway
        setTimeout(() => {
          showDashboard(nombre, apellido, userScore, porcentaje);
        }, 500);
      }
    }

    function showDashboard(nombre, apellido, puntaje, porcentaje) {
      document.getElementById('userFormSection').classList.remove('active');
      document.getElementById('dashboardSection').classList.add('active');
      document.getElementById('scoreDisplay').style.display = 'none';

      document.getElementById('dashboardUserName').textContent = `${nombre} ${apellido}`;
      document.getElementById('dashboardScore').textContent = puntaje;
      document.getElementById('dashboardPercentage').textContent = `${porcentaje}%`;
    
      
    
    }

    // ABRIR MODAL DE PERSONAJE
function showCharacterModal(characterId) {
    const modal = document.getElementById('characterModal');
    const modalContent = document.getElementById('modalCharacterContent');
    const data = characterData[characterId];

    const bgPosition = data.position || 'center center';

    // Fondo del modal con imagen+degradado
    modal.querySelector('.modal-content').style.background = `
        linear-gradient(
            to bottom,
            rgba(0,0,0,0.60) 0%,
            rgba(0,0,0,0.35) 25%,
            rgba(0,0,0,0.15) 60%,
            rgba(0,0,0,0.20) 100%
        ),
        url('${data.image}') ${bgPosition} / cover no-repeat
    `;

    // Contenido
    modalContent.innerHTML = `
        <div class="modal-year">${data.year}</div>
        <div class="modal-title">${data.name}</div>
        <div class="modal-highlight">${data.role}</div>
        <div class="modal-text">${data.content}</div>
    `;

    modal.classList.add('active');
}

// CERRAR MODAL
function closeCharacterModal() {
    const modal = document.getElementById('characterModal');
    modal.classList.remove('active');
}




   function restartTimeline() {

      // üëâ Enviar nota SCORM ANTES de reiniciar todo
      enviarNotaAlSCORM(userScore);

      // Reset all state
      currentEventIndex = 0;
      userScore = 0;
      answeredQuestions.clear();
      
      // Update score display
      document.getElementById('scoreValue').textContent = '0';
      document.getElementById('scoreDisplay').style.display = 'block';
      
      // Reset form
      document.getElementById('nombreInput').value = '';
      document.getElementById('apellidoInput').value = '';
      document.getElementById('submitBtn').disabled = false;
      document.getElementById('submitBtn').textContent = 'Ver Mis Resultados üèÜ';
      
      // Show initial sections
      document.getElementById('charactersSection').style.display = 'block';
      document.getElementById('timelineSection').style.display = 'block';
      document.getElementById('quizSection').classList.remove('active');
      document.getElementById('userFormSection').classList.remove('active');
      document.getElementById('dashboardSection').classList.remove('active');
      
      // Update card to first event
      updateCard();
      
      // Scroll to top
      window.scrollTo({ top: 0, behavior: 'smooth' });
}


    async function onConfigChange(newConfig) {
      config = { ...config, ...newConfig };
      
      const baseSize = config.font_size || defaultConfig.font_size;
      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'sans-serif';
      const fontStack = `${customFont}, ${baseFontStack}`;

      document.body.style.fontFamily = fontStack;
      document.body.style.background = `linear-gradient(135deg, rgba(15, 23, 42, 0.95) 0%, rgba(30, 41, 59, 0.95) 100%), url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><rect fill="${encodeURIComponent(config.primary_color || defaultConfig.primary_color)}" width="1200" height="800"/><path fill="${encodeURIComponent(config.secondary_color || defaultConfig.secondary_color)}" opacity="0.3" d="M0 400 Q300 350 600 400 T1200 400 V800 H0 Z"/><path fill="${encodeURIComponent(config.accent_color || defaultConfig.accent_color)}" opacity="0.1" d="M400 200 L420 180 L440 200 L420 220 Z M800 300 L820 280 L840 300 L820 320 Z M200 500 L220 480 L240 500 L220 520 Z"/><circle cx="600" cy="200" r="80" fill="${encodeURIComponent(config.accent_color || defaultConfig.accent_color)}" opacity="0.15"/><path stroke="${encodeURIComponent(config.accent_color || defaultConfig.accent_color)}" stroke-width="3" fill="none" opacity="0.2" d="M100 600 Q200 550 300 600 T500 600"/></svg>') center/cover fixed`;

      const mainTitle = document.getElementById('main-title');
      if (mainTitle) {
        mainTitle.innerHTML = `<span class="anchor-icon">‚öì</span>${config.main_title || defaultConfig.main_title}`;
        mainTitle.style.fontSize = `${baseSize * 2.625}px`;
        mainTitle.style.fontFamily = fontStack;
        mainTitle.style.color = config.text_color || defaultConfig.text_color;
      }

      const subtitle = document.getElementById('subtitle');
      if (subtitle) {
        subtitle.textContent = config.subtitle || defaultConfig.subtitle;
        subtitle.style.fontSize = `${baseSize * 1.25}px`;
        subtitle.style.fontFamily = fontStack;
        subtitle.style.color = config.text_color || defaultConfig.text_color;
      }

      document.querySelectorAll('.card-year, .modal-year, .percentage-badge, .score-display').forEach(el => {
        el.style.background = `linear-gradient(135deg, ${config.accent_color || defaultConfig.accent_color}, ${config.button_color || defaultConfig.button_color})`;
      });

      document.querySelectorAll('.timeline-card, .quiz-container, .user-form-container, .dashboard-header').forEach(el => {
        el.style.borderColor = config.accent_color || defaultConfig.accent_color;
      });

      document.querySelectorAll('.nav-button, .quiz-continue-btn, .form-submit-btn').forEach(el => {
        el.style.background = `linear-gradient(135deg, ${config.accent_color || defaultConfig.accent_color}, ${config.button_color || defaultConfig.button_color})`;
      });
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [
          {
            get: () => config.primary_color || defaultConfig.primary_color,
            set: (value) => {
              config.primary_color = value;
              window.elementSdk.setConfig({ primary_color: value });
            }
          },
          {
            get: () => config.secondary_color || defaultConfig.secondary_color,
            set: (value) => {
              config.secondary_color = value;
              window.elementSdk.setConfig({ secondary_color: value });
            }
          },
          {
            get: () => config.text_color || defaultConfig.text_color,
            set: (value) => {
              config.text_color = value;
              window.elementSdk.setConfig({ text_color: value });
            }
          },
          {
            get: () => config.accent_color || defaultConfig.accent_color,
            set: (value) => {
              config.accent_color = value;
              window.elementSdk.setConfig({ accent_color: value });
            }
          },
          {
            get: () => config.button_color || defaultConfig.button_color,
            set: (value) => {
              config.button_color = value;
              window.elementSdk.setConfig({ button_color: value });
            }
          }
        ],
        borderables: [],
        fontEditable: {
          get: () => config.font_family || defaultConfig.font_family,
          set: (value) => {
            config.font_family = value;
            window.elementSdk.setConfig({ font_family: value });
          }
        },
        fontSizeable: {
          get: () => config.font_size || defaultConfig.font_size,
          set: (value) => {
            config.font_size = value;
            window.elementSdk.setConfig({ font_size: value });
          }
        }
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ["main_title", config.main_title || defaultConfig.main_title],
        ["subtitle", config.subtitle || defaultConfig.subtitle]
      ]);
    }

    // Data SDK Handler
    const dataHandler = {
      onDataChanged(data) {
        allUserRecords = data || [];
      }
    };

    // Initialize SDKs
    async function initializeSdks() {
      if (window.dataSdk) {
        const initResult = await window.dataSdk.init(dataHandler);
        if (!initResult.isOk) {
          console.error("Error initializing Data SDK");
        }
      }

      if (window.elementSdk) {
        window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities,
          mapToEditPanelValues
        });
      }
    }

    initializeSdks();
    updateCard();

    function startTimeline() {

    // üîá Apagar y reiniciar el video
    const vid = document.getElementById("introVideo");
    vid.pause();
    vid.currentTime = 0;

    // Ocultar video
    document.getElementById("introVideoSection").style.display = "none";

    // Mostrar l√≠nea de tiempo
    document.getElementById("timelineSection").style.display = "block";

    // Mostrar el primer evento correctamente
    updateCard();
}



  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a211bcb610a21b7',t:'MTc2MzczNzc3MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
 
 <!-- MODAL DE PERSONAJES -->
<div id="characterModal" class="modal" onclick="closeCharacterModal()">
  <div class="modal-content" onclick="event.stopPropagation()">
    <button class="modal-close" onclick="closeCharacterModal()">√ó</button>
    <div id="modalCharacterContent"></div>
  </div>
</div>

function enviarNotaALSCORM(puntaje) {
    let API = getAPI();
    if (!API) {
        console.log("No se encontr√≥ API SCORM");
        return;
    }

    // Calcular porcentaje real basado en preguntas correctas
    let totalPreguntas = 5;
    let porcentaje = Math.round((puntaje / totalPreguntas) * 100);

    console.log("üìå Puntaje:", puntaje, "Porcentaje:", porcentaje);

    // Enviar al SCORM
    API.LMSSetValue("cmi.core.score.raw", porcentaje);
    API.LMSSetValue("cmi.core.score.min", "0");
    API.LMSSetValue("cmi.core.score.max", "100");

    // Marcar como completado
    API.LMSSetValue("cmi.core.lesson_status", "completed");

    // Guardar datos sin cerrar sesi√≥n
    API.LMSCommit("");

    console.log("‚úî Nota enviada al SCORM:", porcentaje);
}





 
 </body>
</html>
